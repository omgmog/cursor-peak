<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title></title>
	<style>
		html,body { width: 100%; height: 100%; margin: 0; padding: 0; }
	</style>
</head>
<body>
	<div style="display: none;">
		<img src="peak.png" id="img">
	</div>
	<script>
		(function () {
			var img = {
				id: 'img',
				width: 56,
				height: 128
			};
			var canvas = document.createElement('canvas');
			canvas.width = canvas.height = 128;
			var ctx = canvas.getContext('2d');

			var cx, cy, x, y, drawCursor;

			var updateCursor = function (time) {
				drawCursor = null;
				// clear the canvas
				ctx.clearRect(0,0,canvas.width,canvas.height);

				// debug draw a red square behind the image
				// ctx.fillStyle = 'red';
				// ctx.fillRect(0,0,canvas.width,canvas.height);

				// load image into the canvas
				var image = document.getElementById(img.id);
				ctx.drawImage(image, (128 - cx - image.width - 2), 0);
				// ctx.clearRect(cx,0,(img.width - cx), img.height);
				ctx.save();

				var imgb64 = canvas.toDataURL();
				var urlstring = cx < 128 ? 'url('+imgb64+') 128 0' : 'pointer';
				document.body.style.cursor = urlstring + ', crosshair';

				// debug output
				document.body.appendChild(canvas);

			};

			document.body.addEventListener('mousemove', function (e) {
				cx = e.clientX;
				cy = e.clientY;
				x = cx / window.innerWidth;
				y = cy / window.innerHeight;

				if (!drawCursor) drawCursor = requestAnimationFrame(updateCursor);
			});
		}());
	</script>
</body>
</html>
